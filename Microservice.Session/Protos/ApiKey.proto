syntax = "proto3";

option csharp_namespace = "Microservice.Session.Protos";

import "google/protobuf/timestamp.proto";

service ApiKey {
	// api key
  rpc GetApiKey(ApiKeyRequest) returns (ApiKeyResponse);
  rpc CreateApiKey(CreateApiKeyRequest) returns (ApiHashResponse);
  rpc RegenerateApiKey(ApiKeyRequest) returns (ApiHashResponse);
  rpc RenewApiKey(RenewApiKeyRequest) returns (ApiKeyResponse);
  rpc RevokeApiKey(ApiKeyRequest) returns (ApiKeyResponse);

  // user info
  rpc GetUserInfo(UserInfoRequest) returns (UserInfoResponse);

    // Session section
  rpc GetSessionList(SessionListRequest) returns (SessionListResponse);
}

// api key
message ApiKeyRequest {
  string user_id = 1;
}

message ApiKeyResponse {
  string user_id = 1;
  string org_name = 2;
  string domain = 3;
  string org_email = 4;
  string plan = 5;
  google.protobuf.Timestamp expiration_date = 6;
  google.protobuf.Timestamp created_at = 7;
  int32 request_limit = 8;
  google.protobuf.Timestamp reset_date = 9;
  bool is_revoked = 10;
  bool is_active = 11;
  string TanantId = 12;
}

message CreateApiKeyRequest {
  string user_id = 1;
  string org_name = 2;
  string domain = 3;
  string org_email = 4;
  string plan = 5;
  google.protobuf.Timestamp expiration_date = 6;
  google.protobuf.Timestamp created_at = 7;
  int32 request_limit = 8;
}

message ApiHashResponse {
  string api_hash = 1;
  string TanantId = 2;
}

message RenewApiKeyRequest {
	string user_id = 1;
	string plan = 2;
	int32 request_limit = 3;
	google.protobuf.Timestamp expiration_date = 4;
	bool is_revoked = 5;
}

// user info
message UserInfoRequest{
	string user_id = 1;
	string TenantId = 2;
}

message UserInfoResponse{
	string user_name = 1;
	string user_email = 2;
	string lastlogin = 3;
}

// Session section
message SessionListRequest{
	string TenantId =1;
	google.protobuf.Timestamp from = 2;
	google.protobuf.Timestamp to = 3;
	string device = 4;
	string country =5;
}

message SessionListResponse{
	string user_name =1;
	string email = 2;
	string ip_address = 3;
	string city = 4;
	string country = 5;
	string Region = 6;
	string status = 7;
	string device_Os = 8;
	google.protobuf.Timestamp login_Time = 9;
	string lac = 10;
	string sessionid = 11;
}